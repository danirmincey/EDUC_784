<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.12 Exercises | EDUC 784: Regression</title>
  <meta name="description" content="Course notes for EDUC 784" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="2.12 Exercises | EDUC 784: Regression" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/image1.png" />
  <meta property="og:description" content="Course notes for EDUC 784" />
  <meta name="github-repo" content="peterhalpin/EDUC_784" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.12 Exercises | EDUC 784: Regression" />
  
  <meta name="twitter:description" content="Course notes for EDUC 784" />
  <meta name="twitter:image" content="/images/image1.png" />

<meta name="author" content="Peter Halpin" />


<meta name="date" content="2023-01-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="2.11-workbook-2.html"/>
<link rel="next" href="2.13-review-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Course notes for EDUC 784</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About This Book</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-why-this-format.html"><a href="1.1-why-this-format.html"><i class="fa fa-check"></i><b>1.1</b> Why this format?</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-tips-for-using-the-notes.html"><a href="1.2-tips-for-using-the-notes.html"><i class="fa fa-check"></i><b>1.2</b> Tips for using the notes</a></li>
<li class="chapter" data-level="1.3" data-path="1.3-summary.html"><a href="1.3-summary.html"><i class="fa fa-check"></i><b>1.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-chapter-2.html"><a href="2-chapter-2.html"><i class="fa fa-check"></i><b>2</b> Simple Regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-example-2.html"><a href="2.1-example-2.html"><i class="fa fa-check"></i><b>2.1</b> An example from NELS</a></li>
<li class="chapter" data-level="2.2" data-path="2.2-regression-line-2.html"><a href="2.2-regression-line-2.html"><i class="fa fa-check"></i><b>2.2</b> The regression line</a></li>
<li class="chapter" data-level="2.3" data-path="2.3-ols-2.html"><a href="2.3-ols-2.html"><i class="fa fa-check"></i><b>2.3</b> OLS</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2.3-ols-2.html"><a href="2.3-ols-2.html#correlation-and-regression"><i class="fa fa-check"></i><b>2.3.1</b> Correlation and regression</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2.4-rsquared-2.html"><a href="2.4-rsquared-2.html"><i class="fa fa-check"></i><b>2.4</b> R-squared</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="2.4-rsquared-2.html"><a href="2.4-rsquared-2.html#derivation"><i class="fa fa-check"></i><b>2.4.1</b> Derivation*</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2.5-population-model-2.html"><a href="2.5-population-model-2.html"><i class="fa fa-check"></i><b>2.5</b> The population model</a></li>
<li class="chapter" data-level="2.6" data-path="2.6-notation-2.html"><a href="2.6-notation-2.html"><i class="fa fa-check"></i><b>2.6</b> Clarifying notation</a></li>
<li class="chapter" data-level="2.7" data-path="2.7-inference-for-slope-2.html"><a href="2.7-inference-for-slope-2.html"><i class="fa fa-check"></i><b>2.7</b> Inference for the slope</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="2.7-inference-for-slope-2.html"><a href="2.7-inference-for-slope-2.html#t-tests"><i class="fa fa-check"></i><b>2.7.1</b> t-tests</a></li>
<li class="chapter" data-level="2.7.2" data-path="2.7-inference-for-slope-2.html"><a href="2.7-inference-for-slope-2.html#confidence-intervals"><i class="fa fa-check"></i><b>2.7.2</b> Confidence intervals</a></li>
<li class="chapter" data-level="2.7.3" data-path="2.7-inference-for-slope-2.html"><a href="2.7-inference-for-slope-2.html#the-nels-example"><i class="fa fa-check"></i><b>2.7.3</b> The NELS example</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="2.8-inference-for-intercept-2.html"><a href="2.8-inference-for-intercept-2.html"><i class="fa fa-check"></i><b>2.8</b> Inference for the intercept</a></li>
<li class="chapter" data-level="2.9" data-path="2.9-inference-for-rsquared-2.html"><a href="2.9-inference-for-rsquared-2.html"><i class="fa fa-check"></i><b>2.9</b> Inference for R-squared</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="2.9-inference-for-rsquared-2.html"><a href="2.9-inference-for-rsquared-2.html#f-tests"><i class="fa fa-check"></i><b>2.9.1</b> F-tests</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="2.10-power-2.html"><a href="2.10-power-2.html"><i class="fa fa-check"></i><b>2.10</b> Power analysis</a></li>
<li class="chapter" data-level="2.11" data-path="2.11-workbook-2.html"><a href="2.11-workbook-2.html"><i class="fa fa-check"></i><b>2.11</b> Workbook</a></li>
<li class="chapter" data-level="2.12" data-path="2.12-exercises-2.html"><a href="2.12-exercises-2.html"><i class="fa fa-check"></i><b>2.12</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.12.1" data-path="2.12-exercises-2.html"><a href="2.12-exercises-2.html#the-lm-function"><i class="fa fa-check"></i><b>2.12.1</b> The <code>lm</code> function</a></li>
<li class="chapter" data-level="2.12.2" data-path="2.12-exercises-2.html"><a href="2.12-exercises-2.html#variance-explained"><i class="fa fa-check"></i><b>2.12.2</b> Variance explained</a></li>
<li class="chapter" data-level="2.12.3" data-path="2.12-exercises-2.html"><a href="2.12-exercises-2.html#predicted-values-and-residuals"><i class="fa fa-check"></i><b>2.12.3</b> Predicted values and residuals</a></li>
<li class="chapter" data-level="2.12.4" data-path="2.12-exercises-2.html"><a href="2.12-exercises-2.html#inference"><i class="fa fa-check"></i><b>2.12.4</b> Inference</a></li>
<li class="chapter" data-level="2.12.5" data-path="2.12-exercises-2.html"><a href="2.12-exercises-2.html#power-analysis"><i class="fa fa-check"></i><b>2.12.5</b> Power analysis</a></li>
<li class="chapter" data-level="2.12.6" data-path="2.12-exercises-2.html"><a href="2.12-exercises-2.html#additional-exercises"><i class="fa fa-check"></i><b>2.12.6</b> Additional exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="2.13-review-2.html"><a href="2.13-review-2.html"><i class="fa fa-check"></i><b>2.13</b> Review</a>
<ul>
<li class="chapter" data-level="2.13.1" data-path="2.13-review-2.html"><a href="2.13-review-2.html#summation-algebra"><i class="fa fa-check"></i><b>2.13.1</b> Summation algebra</a></li>
<li class="chapter" data-level="2.13.2" data-path="2.13-review-2.html"><a href="2.13-review-2.html#sample-statistics"><i class="fa fa-check"></i><b>2.13.2</b> Sample statistics</a></li>
<li class="chapter" data-level="2.13.3" data-path="2.13-review-2.html"><a href="2.13-review-2.html#bias-and-precision"><i class="fa fa-check"></i><b>2.13.3</b> Bias and precision</a></li>
<li class="chapter" data-level="2.13.4" data-path="2.13-review-2.html"><a href="2.13-review-2.html#t-tests-1"><i class="fa fa-check"></i><b>2.13.4</b> t-tests</a></li>
<li class="chapter" data-level="2.13.5" data-path="2.13-review-2.html"><a href="2.13-review-2.html#confidence-intervals-1"><i class="fa fa-check"></i><b>2.13.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="2.13.6" data-path="2.13-review-2.html"><a href="2.13-review-2.html#f-tests-1"><i class="fa fa-check"></i><b>2.13.6</b> F-tests</a></li>
<li class="chapter" data-level="2.13.7" data-path="2.13-review-2.html"><a href="2.13-review-2.html#apa-reporting"><i class="fa fa-check"></i><b>2.13.7</b> APA reporting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/peterhalpin/EDUC_784" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EDUC 784: Regression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercises-2" class="section level2 hasAnchor" number="2.12">
<h2><span class="header-section-number">2.12</span> Exercises<a href="2.12-exercises-2.html#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>These exercises collect all of the R input used in this chapter into a single step-by-step analysis. It explains how the R input works, and provides some some additional exercises. We will go through this material in class together, so you don’t need to work on it before class (but you can if you want.)</p>
<div id="the-lm-function" class="section level3 hasAnchor" number="2.12.1">
<h3><span class="header-section-number">2.12.1</span> The <code>lm</code> function<a href="2.12-exercises-2.html#the-lm-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The function<code>lm</code>, short for “linear model”, is used to estimate linear regressions using OLS. It also provides a lot of useful output.</p>
<p>The main argument that the user provides to the <code>lm</code> function is a formula. For the simple regression of Y on X, a formula has the syntax:</p>
<p><code>Y ~ X</code></p>
<p>Here <code>Y</code> denotes the outcome variable and <code>X</code> is the predictor variable. The tilde <code>~</code> just means “equals”, but the equals sign <code>=</code> is already used to assign values in R, so <code>~</code> is used in its place when writing a formula. We will see more complicated formulas as we go through the course. For more information on R’s formula syntax, see <code>help(formula)</code>.</p>
<p>Let’s take a closer look using the following two variables from the NELS data.</p>
<ul>
<li><p><code>achmat08</code>: eighth grade math achievement (percent correct on a math test)</p></li>
<li><p><code>ses</code>: a composite measure of socio-economic status, on a scale from 0-35</p></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="2.12-exercises-2.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data. Note that you can click on the .RData file and RStudio will load it</span></span>
<span id="cb30-2"><a href="2.12-exercises-2.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load(&quot;NELS.RData&quot;) #Un-comment this line to run</span></span>
<span id="cb30-3"><a href="2.12-exercises-2.html#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="2.12-exercises-2.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Attach the data: will dicuss this in class</span></span>
<span id="cb30-5"><a href="2.12-exercises-2.html#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># attach(NELS) #Un-comment this line to run!</span></span>
<span id="cb30-6"><a href="2.12-exercises-2.html#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="2.12-exercises-2.html#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of math achievment against SES</span></span>
<span id="cb30-8"><a href="2.12-exercises-2.html#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> ses, <span class="at">y =</span> achmat08, <span class="at">col =</span> <span class="st">&quot;#4B9CD3&quot;</span>)</span>
<span id="cb30-9"><a href="2.12-exercises-2.html#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="2.12-exercises-2.html#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Regress math achievement on SES; save output as &quot;mod&quot;</span></span>
<span id="cb30-11"><a href="2.12-exercises-2.html#cb30-11" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(achmat08 <span class="sc">~</span> ses)</span>
<span id="cb30-12"><a href="2.12-exercises-2.html#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="2.12-exercises-2.html#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the regression line to the plot</span></span>
<span id="cb30-14"><a href="2.12-exercises-2.html#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mod)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="2.12-exercises-2.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print out the regression coefficients</span></span>
<span id="cb31-2"><a href="2.12-exercises-2.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod)</span></code></pre></div>
<pre><code>## (Intercept)         ses 
##    48.67803     0.42926</code></pre>
<p>Let’s do some quick calculations to check that the <code>lm</code> output corresponds the formulas for the slope and intercept in Section <a href="2.3-ols-2.html#ols-2">2.3</a>:</p>
<p><span class="math display">\[ a = \bar Y - b \bar X \quad \text{and} \quad b = \frac{\text{Cov}(X, Y)}{s_X^2} \]</span>
We won’t usually do these kind of “manual” calculations, but it is a good way consolidate knowledge presented in the readings with the output presented by R. It is also useful to refresh our memory about some useful R functions and how the R language works.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="2.12-exercises-2.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confirm that the slope from lm is equal to the covariance divided by the variance of X</span></span>
<span id="cb33-2"><a href="2.12-exercises-2.html#cb33-2" aria-hidden="true" tabindex="-1"></a>cov_xy <span class="ot">&lt;-</span> <span class="fu">cov</span>(achmat08, ses)</span>
<span id="cb33-3"><a href="2.12-exercises-2.html#cb33-3" aria-hidden="true" tabindex="-1"></a>s_x <span class="ot">&lt;-</span> <span class="fu">var</span>(ses)</span>
<span id="cb33-4"><a href="2.12-exercises-2.html#cb33-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> cov_xy <span class="sc">/</span> s_x</span>
<span id="cb33-5"><a href="2.12-exercises-2.html#cb33-5" aria-hidden="true" tabindex="-1"></a>b</span></code></pre></div>
<pre><code>## [1] 0.42926</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="2.12-exercises-2.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confirm that the y-intercept is obtained from the two means and the slope</span></span>
<span id="cb35-2"><a href="2.12-exercises-2.html#cb35-2" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(ses)</span>
<span id="cb35-3"><a href="2.12-exercises-2.html#cb35-3" aria-hidden="true" tabindex="-1"></a>ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(achmat08)</span>
<span id="cb35-4"><a href="2.12-exercises-2.html#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="2.12-exercises-2.html#cb35-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> ybar <span class="sc">-</span> b <span class="sc">*</span> xbar</span>
<span id="cb35-6"><a href="2.12-exercises-2.html#cb35-6" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1] 48.678</code></pre>
<p>Let’s also check our interpretation of the parameters. If the answers to these questions are not clear, please make sure to ask in class!</p>
<ul>
<li><p>What is the predicted value of <code>achmat08</code> when <code>ses</code> is equal to zero?</p></li>
<li><p>How much does the predicted value of <code>achmat08</code> increase for each unit of increase in <code>ses</code>?</p></li>
</ul>
</div>
<div id="variance-explained" class="section level3 hasAnchor" number="2.12.2">
<h3><span class="header-section-number">2.12.2</span> Variance explained<a href="2.12-exercises-2.html#variance-explained" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Above we found out that the regression coefficient was 0.4-ish. Another way to describe the relationships is by considering the amount of variation in <span class="math inline">\(Y\)</span> that is associated with (or explained by) its relationship with <span class="math inline">\(X\)</span>. Recall that one way to do this is via the variance decomposition</p>
<p><span class="math display">\[ SS_{\text{total}} = SS_{\text{res}} + SS_{\text{reg}}\]</span></p>
<p>from which we can compute the proportion of variation in Y that is associated with the regression model</p>
<p><span class="math display">\[R^2 = \frac{SS_{\text{reg}}}{SS_{\text{total}}}\]</span></p>
<p>The R-squared for the example is presented in the output below. You should be able to provide an interpretation of this number, so if it’s not clear make sure to ask in class!</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="2.12-exercises-2.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared from the example</span></span>
<span id="cb37-2"><a href="2.12-exercises-2.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.10128</code></pre>
<p>As above, let’s compute <span class="math inline">\(R^2\)</span> “by hand” for our example.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="2.12-exercises-2.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the sums of squares</span></span>
<span id="cb39-2"><a href="2.12-exercises-2.html#cb39-2" aria-hidden="true" tabindex="-1"></a>ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(achmat08)</span>
<span id="cb39-3"><a href="2.12-exercises-2.html#cb39-3" aria-hidden="true" tabindex="-1"></a>ss_total <span class="ot">&lt;-</span> <span class="fu">sum</span>((achmat08 <span class="sc">-</span> ybar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb39-4"><a href="2.12-exercises-2.html#cb39-4" aria-hidden="true" tabindex="-1"></a>ss_reg <span class="ot">&lt;-</span> <span class="fu">sum</span>((yhat <span class="sc">-</span> ybar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb39-5"><a href="2.12-exercises-2.html#cb39-5" aria-hidden="true" tabindex="-1"></a>ss_res <span class="ot">&lt;-</span>  <span class="fu">sum</span>((achmat08 <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb39-6"><a href="2.12-exercises-2.html#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="2.12-exercises-2.html#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that SS_total = SS_reg + SS_res</span></span>
<span id="cb39-8"><a href="2.12-exercises-2.html#cb39-8" aria-hidden="true" tabindex="-1"></a>ss_total</span></code></pre></div>
<pre><code>## [1] 43527</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="2.12-exercises-2.html#cb41-1" aria-hidden="true" tabindex="-1"></a>ss_reg <span class="sc">+</span> ss_res</span></code></pre></div>
<pre><code>## [1] 43527</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="2.12-exercises-2.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute R-squared</span></span>
<span id="cb43-2"><a href="2.12-exercises-2.html#cb43-2" aria-hidden="true" tabindex="-1"></a>ss_reg<span class="sc">/</span>ss_total</span></code></pre></div>
<pre><code>## [1] 0.10128</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="2.12-exercises-2.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that R-squared is really equal to the square of the PPMC</span></span>
<span id="cb45-2"><a href="2.12-exercises-2.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(achmat08, ses)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 0.10128</code></pre>
</div>
<div id="predicted-values-and-residuals" class="section level3 hasAnchor" number="2.12.3">
<h3><span class="header-section-number">2.12.3</span> Predicted values and residuals<a href="2.12-exercises-2.html#predicted-values-and-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>lm</code> function also returns the residuals <span class="math inline">\(e_i\)</span> and the predicted values <span class="math inline">\(\widehat{Y_i}\)</span>, which we can access using the <code>$</code> operator. These are useful for various reasons, especially model diagnostics which we discuss later in the course. For now, lets just take a look at the residual vs fitted plot to illustrate the code.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="2.12-exercises-2.html#cb47-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> mod<span class="sc">$</span>fitted.values</span>
<span id="cb47-2"><a href="2.12-exercises-2.html#cb47-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> mod<span class="sc">$</span>resid</span>
<span id="cb47-3"><a href="2.12-exercises-2.html#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="2.12-exercises-2.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yhat, res, <span class="at">col =</span> <span class="st">&quot;#4B9CD3&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="2.12-exercises-2.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(yhat, res)</span></code></pre></div>
<pre><code>## [1] -2.4274e-16</code></pre>
<p>Note that the predicted values are uncorrelated with the residuals – this is always the case in OLS.</p>
</div>
<div id="inference" class="section level3 hasAnchor" number="2.12.4">
<h3><span class="header-section-number">2.12.4</span> Inference<a href="2.12-exercises-2.html#inference" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next let’s talk about statistical inference, or how we can make conclusions about a population based on a sample from that population.</p>
<p>We can use the <code>summary</code> function to test the coefficients in our model.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="2.12-exercises-2.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = achmat08 ~ ses)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -20.600  -6.552  -0.148   6.023  27.663 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  48.6780     1.1282   43.15  &lt; 2e-16 ***
## ses           0.4293     0.0573    7.49  3.1e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.86 on 498 degrees of freedom
## Multiple R-squared:  0.101,  Adjusted R-squared:  0.0995 
## F-statistic: 56.1 on 1 and 498 DF,  p-value: 3.13e-13</code></pre>
<p>In the table, the t-test and p-values are for the null hypothesis that the corresponding coefficient is zero in the population. We can see that the intercept and slope are both significantly different from zero at the .05 level. However, the test of the intercept is not very meaningful (why?).</p>
<p>The text below the table summarizes the output for R-squared, including its F-test, it’s degrees of freedom, and the p-value. (We will talk about adjusted R-square in Chapter 4)</p>
<p>We can also use the <code>confint</code> function to obtain confidence intervals for the regression coefficients. Use <code>help</code> to find out more about the <code>confint</code> function.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="2.12-exercises-2.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod)</span></code></pre></div>
<pre><code>##                2.5 %   97.5 %
## (Intercept) 46.46146 50.89461
## ses          0.31668  0.54184</code></pre>
<p>Be sure to remember the correct interpretation of confidence intervals: <em>there is a 95% chance that the interval includes the true parameter value</em> (not: there is a 95% chance that the parameter falls in the interval). For example, there is a 95% chance that the interval [.31, .54] includes the true regression coefficient for SES.</p>
</div>
<div id="power-analysis" class="section level3 hasAnchor" number="2.12.5">
<h3><span class="header-section-number">2.12.5</span> Power analysis<a href="2.12-exercises-2.html#power-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Power analyses should ideally be done before the data are collected. Since this class will work with secondary data analyses, most of our analyses will be retrospective. But don’t let this mislead you about the importance of statistical power – you should always do a power analysis before collecting data!!</p>
<p>To do a power analsyis in R, we can install and load the <code>pwr</code> package. If you haven’t installed an R package before, it’s pretty straight forward – but just ask the instructor or a fellow student if you run into any issues.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="2.12-exercises-2.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install the package </span></span>
<span id="cb54-2"><a href="2.12-exercises-2.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;pwr&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="2.12-exercises-2.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the package by using the library command</span></span>
<span id="cb55-2"><a href="2.12-exercises-2.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;pwr&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="2.12-exercises-2.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the help menu to see what the package does</span></span>
<span id="cb56-2"><a href="2.12-exercises-2.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(<span class="st">&quot;pwr-package&quot;</span>)</span></code></pre></div>
<p>To do a power analysis for linear regression, it is common to use Cohen’s <span class="math inline">\(f^2\)</span> as the effect size:</p>
<p><span class="math display">\[f^2 = \frac{R^2}{1-R^2}.\]</span></p>
<p>Recall that <span class="math inline">\(R^2\)</span> is the proportion of variance in <span class="math inline">\(Y\)</span> explained by the model, and so <span class="math inline">\(1 - R^2\)</span> is the proportion of variance not explained by the model. Thus, <span class="math inline">\(f^2\)</span> can be interpreted as a signal to noise ratio.</p>
<p>In addition to the effect size, we need to know the degrees of freedom for the F-test of R-square. The <code>pwr</code> functions use the following notation:</p>
<ul>
<li><code>u</code> is the degrees of freedom in the numerator of an F-test.</li>
<li><code>v</code> is the degrees of freedom in the denominator of an F-test.</li>
</ul>
<p>In simple regression, <code>u = 1</code> and <code>v = N - 2</code>.</p>
<p>As an example of (prospective) power analysis, let’s find out many observations would be required to detect an effet size of R-square = .1, using <span class="math inline">\(\alpha = .05\)</span> and power = .8. To find the answer, enter the provided information into the <code>pwr.f2.test</code> function, and the function will solve for the “missing piece” – in this case <span class="math inline">\(v = N - 2\)</span>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="2.12-exercises-2.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the provided values of R2, alpha, power (and u = 1) to solve for v = N - 2</span></span>
<span id="cb57-2"><a href="2.12-exercises-2.html#cb57-2" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> .<span class="dv">1</span></span>
<span id="cb57-3"><a href="2.12-exercises-2.html#cb57-3" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> R2<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>R2)</span>
<span id="cb57-4"><a href="2.12-exercises-2.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.f2.test</span>(<span class="at">u =</span> <span class="dv">1</span>, <span class="at">f2 =</span> f2, <span class="at">sig.level =</span> .<span class="dv">05</span>, <span class="at">power =</span> .<span class="dv">8</span>)</span></code></pre></div>
<pre><code>## 
##      Multiple regression power calculation 
## 
##               u = 1
##               v = 70.611
##              f2 = 0.11111
##       sig.level = 0.05
##           power = 0.8</code></pre>
<p>In this example we find that <span class="math inline">\(v = 70.6\)</span>. Since <span class="math inline">\(v = N - 2\)</span>, so we know that a sample size of <span class="math inline">\(N = 72.6\)</span> (rounded up to 73) is required to reject the null hypothesis that <span class="math inline">\(R^2 = 0\)</span>, when the true population value is <span class="math inline">\(R^2 = .1\)</span>, with a power of .8 and using a significance level of .05.</p>
</div>
<div id="additional-exercises" class="section level3 hasAnchor" number="2.12.6">
<h3><span class="header-section-number">2.12.6</span> Additional exercises<a href="2.12-exercises-2.html#additional-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If time permits, we will address these additional exercises in class.</p>
<p>These exercises replace <code>achmat08</code> with</p>
<ul>
<li><code>achrdg08</code>: eighth grade Reading Achievement (percent correct on a reading test)</li>
</ul>
<p>Please answer the following questions using R.</p>
<ul>
<li><p>Plot <code>achrdg08</code> against <code>ses</code>. Is there any evidence of nonlinearity in the relationship?</p></li>
<li><p>What is the correlation between <code>achrdg08</code> and <code>ses</code>? How does it compare to the correlation with Math and SES?</p></li>
<li><p>How much variation in Reading is explained by SES? Is this more or less than for Math? Is the proportion of variance explained significant at the .05 level?</p></li>
<li><p>How much do predicted Reading scores increase for a one unit of increase in SES? Is this a statistically significant at the .05 level?</p></li>
<li><p>What are your overall conclusions about the relationship between Academic Achievement and SES in the NELS data?</p></li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2.11-workbook-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="2.13-review-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/peterhalpin/EDUC_784/edit/master/02_simple_regression.Rmd",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
