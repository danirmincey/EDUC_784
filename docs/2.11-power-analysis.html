<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.11 Power analysis | EDUC 784: Regression</title>
  <meta name="description" content="Course notes for EDUC 784" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2.11 Power analysis | EDUC 784: Regression" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/image1.png" />
  <meta property="og:description" content="Course notes for EDUC 784" />
  <meta name="github-repo" content="peterhalpin/EDUC_784" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.11 Power analysis | EDUC 784: Regression" />
  
  <meta name="twitter:description" content="Course notes for EDUC 784" />
  <meta name="twitter:image" content="/images/image1.png" />

<meta name="author" content="Peter Halpin" />


<meta name="date" content="2022-01-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="null" type="image/x-icon" />
<link rel="prev" href="2.10-inference.html"/>
<link rel="next" href="2.12-exercises.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Course notes for EDUC 784</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About This Book</a><ul>
<li class="chapter" data-level="1.1" data-path="1.1-why-this-book.html"><a href="1.1-why-this-book.html"><i class="fa fa-check"></i><b>1.1</b> Why this book?</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-how-to-use-this-book.html"><a href="1.2-how-to-use-this-book.html"><i class="fa fa-check"></i><b>1.2</b> How to use this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-Chapter-2.html"><a href="2-Chapter-2.html"><i class="fa fa-check"></i><b>2</b> Simple Regression</a><ul>
<li class="chapter" data-level="2.1" data-path="2.1-an-example-from-nels.html"><a href="2.1-an-example-from-nels.html"><i class="fa fa-check"></i><b>2.1</b> An example from NELS</a></li>
<li class="chapter" data-level="2.2" data-path="2.2-the-regression-line.html"><a href="2.2-the-regression-line.html"><i class="fa fa-check"></i><b>2.2</b> The regression line</a></li>
<li class="chapter" data-level="2.3" data-path="2.3-three-uses-of-regression.html"><a href="2.3-three-uses-of-regression.html"><i class="fa fa-check"></i><b>2.3</b> Three uses of regression</a></li>
<li class="chapter" data-level="2.4" data-path="2.4-regression-for-prediction.html"><a href="2.4-regression-for-prediction.html"><i class="fa fa-check"></i><b>2.4</b> Regression for prediction</a></li>
<li class="chapter" data-level="2.5" data-path="2.5-regression-and-causation.html"><a href="2.5-regression-and-causation.html"><i class="fa fa-check"></i><b>2.5</b> Regression and causation</a></li>
<li class="chapter" data-level="2.6" data-path="2.6-regression-for-explanation.html"><a href="2.6-regression-for-explanation.html"><i class="fa fa-check"></i><b>2.6</b> Regression for explanation</a></li>
<li class="chapter" data-level="2.7" data-path="2.7-the-lm-function.html"><a href="2.7-the-lm-function.html"><i class="fa fa-check"></i><b>2.7</b> The <code>lm</code> function</a></li>
<li class="chapter" data-level="2.8" data-path="2.8-predicted-values-and-residuals.html"><a href="2.8-predicted-values-and-residuals.html"><i class="fa fa-check"></i><b>2.8</b> Predicted values and residuals</a></li>
<li class="chapter" data-level="2.9" data-path="2.9-variance-explained.html"><a href="2.9-variance-explained.html"><i class="fa fa-check"></i><b>2.9</b> Variance explained</a></li>
<li class="chapter" data-level="2.10" data-path="2.10-inference.html"><a href="2.10-inference.html"><i class="fa fa-check"></i><b>2.10</b> Inference</a></li>
<li class="chapter" data-level="2.11" data-path="2.11-power-analysis.html"><a href="2.11-power-analysis.html"><i class="fa fa-check"></i><b>2.11</b> Power analysis</a><ul>
<li class="chapter" data-level="2.11.1" data-path="2.11-power-analysis.html"><a href="2.11-power-analysis.html#example-a-prospective-power-analysis"><i class="fa fa-check"></i><b>2.11.1</b> Example: A prospective power analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="2.12-exercises.html"><a href="2.12-exercises.html"><i class="fa fa-check"></i><b>2.12</b> Exercises</a><ul>
<li class="chapter" data-level="2.12.1" data-path="2.12-exercises.html"><a href="2.12-exercises.html#answers"><i class="fa fa-check"></i><b>2.12.1</b> Answers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-parts.html"><a href="3-parts.html"><i class="fa fa-check"></i><b>3</b> Parts</a></li>
<li class="chapter" data-level="4" data-path="4-footnotes-and-citations.html"><a href="4-footnotes-and-citations.html"><i class="fa fa-check"></i><b>4</b> Footnotes and citations</a><ul>
<li class="chapter" data-level="4.1" data-path="4.1-footnotes.html"><a href="4.1-footnotes.html"><i class="fa fa-check"></i><b>4.1</b> Footnotes</a></li>
<li class="chapter" data-level="4.2" data-path="4.2-citations.html"><a href="4.2-citations.html"><i class="fa fa-check"></i><b>4.2</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-blocks.html"><a href="5-blocks.html"><i class="fa fa-check"></i><b>5</b> Blocks</a><ul>
<li class="chapter" data-level="5.1" data-path="5.1-equations.html"><a href="5.1-equations.html"><i class="fa fa-check"></i><b>5.1</b> Equations</a></li>
<li class="chapter" data-level="5.2" data-path="5.2-theorems-and-proofs.html"><a href="5.2-theorems-and-proofs.html"><i class="fa fa-check"></i><b>5.2</b> Theorems and proofs</a></li>
<li class="chapter" data-level="5.3" data-path="5.3-callout-blocks.html"><a href="5.3-callout-blocks.html"><i class="fa fa-check"></i><b>5.3</b> Callout blocks</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-sharing-your-book.html"><a href="6-sharing-your-book.html"><i class="fa fa-check"></i><b>6</b> Sharing your book</a><ul>
<li class="chapter" data-level="6.1" data-path="6.1-publishing.html"><a href="6.1-publishing.html"><i class="fa fa-check"></i><b>6.1</b> Publishing</a></li>
<li class="chapter" data-level="6.2" data-path="6.2-pages.html"><a href="6.2-pages.html"><i class="fa fa-check"></i><b>6.2</b> 404 pages</a></li>
<li class="chapter" data-level="6.3" data-path="6.3-metadata-for-sharing.html"><a href="6.3-metadata-for-sharing.html"><i class="fa fa-check"></i><b>6.3</b> Metadata for sharing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="7" data-path="7-cross.html"><a href="7-cross.html"><i class="fa fa-check"></i><b>7</b> Cross-references</a><ul>
<li class="chapter" data-level="7.1" data-path="7.1-chapters-and-sub-chapters.html"><a href="7.1-chapters-and-sub-chapters.html"><i class="fa fa-check"></i><b>7.1</b> Chapters and sub-chapters</a></li>
<li class="chapter" data-level="7.2" data-path="7.2-captioned-figures-and-tables.html"><a href="7.2-captioned-figures-and-tables.html"><i class="fa fa-check"></i><b>7.2</b> Captioned figures and tables</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/peterhalpin/EDUC_784" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EDUC 784: Regression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="power-analysis" class="section level2">
<h2><span class="header-section-number">2.11</span> Power analysis</h2>
<p>Power analyses should ideally be done prospectively – i.e., before the data are collected. Since this class will work with secondary data analyses, most of our analyses will be retrospective. But don’t let this mislead you about the importance of statistical power – you should always do a power analysis before collecting data!!</p>
<p>To do a power analsyes in R, we can install and load the <code>pwr</code> package. If you haven’t installed an R package before it’s pretty straight forward – but just ask course staff or a fellow student if you run into any issues.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="2.11-power-analysis.html#cb32-1"></a><span class="co"># Install the package </span></span>
<span id="cb32-2"><a href="2.11-power-analysis.html#cb32-2"></a><span class="co"># Note you may have to select a mirror -- I suggest using Kansas (KS) </span></span>
<span id="cb32-3"><a href="2.11-power-analysis.html#cb32-3"></a><span class="kw">install.packages</span>(<span class="st">&quot;pwr&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="2.11-power-analysis.html#cb33-1"></a><span class="co"># Load the package by using the library command</span></span>
<span id="cb33-2"><a href="2.11-power-analysis.html#cb33-2"></a><span class="kw">library</span>(<span class="st">&quot;pwr&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="2.11-power-analysis.html#cb34-1"></a><span class="co"># Use the help menu to see what the package does</span></span>
<span id="cb34-2"><a href="2.11-power-analysis.html#cb34-2"></a><span class="kw">help</span>(<span class="st">&quot;pwr-package&quot;</span>)</span></code></pre></div>
<p>To do a power analysis for linear regression, it is common to use Cohen’s <span class="math inline">\(f^2\)</span> as the effect size:</p>
<p><span class="math display">\[f^2 = \frac{R^2}{1-R^2}.\]</span></p>
<p>Recall that <span class="math inline">\(R^2\)</span> is the proportion of variance in <span class="math inline">\(Y\)</span> explained by the model, and so <span class="math inline">\(1 - R^2\)</span> is the proportion of variance not explained by the model. Thus, <span class="math inline">\(f^2\)</span> can be interpreted as a signal to noise ratio.</p>
<p>In addition to the effect size, we need to know the degrees of freedom for the F-test of R-square. The <code>pwr</code> functions use the following notation:</p>
<ul>
<li><code>u</code> is the degrees of freedom in the numerator of an F-test.</li>
<li><code>v</code> is the degrees of freedom in the denominator of an F-test.</li>
</ul>
<p>In simple regression, <code>u = 1</code> and <code>v = N - 2</code>.</p>
<div id="example-a-prospective-power-analysis" class="section level3">
<h3><span class="header-section-number">2.11.1</span> Example: A prospective power analysis</h3>
<p>How many observations would be required to detect an effet size of R-square = .1, using <span class="math inline">\(\alpha = .05\)</span> and power = .8? To find the answer, enter the provided information into the <code>pwr.f2.test</code> function, and the function will solve for the “missing piece” – in this case <span class="math inline">\(v = N - 2\)</span>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="2.11-power-analysis.html#cb35-1"></a><span class="co"># Use the provided values of R2, alpha, power (and u = 1) to solve for v = N - 2</span></span>
<span id="cb35-2"><a href="2.11-power-analysis.html#cb35-2"></a>R2 &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb35-3"><a href="2.11-power-analysis.html#cb35-3"></a>f2 &lt;-<span class="st"> </span>R2<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>R2)</span>
<span id="cb35-4"><a href="2.11-power-analysis.html#cb35-4"></a><span class="kw">pwr.f2.test</span>(<span class="dt">u =</span> <span class="dv">1</span>, <span class="dt">f2 =</span> f2, <span class="dt">sig.level =</span> <span class="fl">.05</span>, <span class="dt">power =</span> <span class="fl">.8</span>)</span></code></pre></div>
<pre><code>## 
##      Multiple regression power calculation 
## 
##               u = 1
##               v = 71
##              f2 = 0.11
##       sig.level = 0.05
##           power = 0.8</code></pre>
<p>In this example we find that <span class="math inline">\(v = 70.6\)</span>. Since <span class="math inline">\(v = N - 2\)</span>, so we know that a sample size of <span class="math inline">\(N = 72.6\)</span> (rounded up to 73) is required to reject the null hypothesis that <span class="math inline">\(R^2 = 0\)</span>, when the true popuation value is <span class="math inline">\(R^2 = .1\)</span>, with a power of .8 and using a significance level of .05.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2.10-inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="2.12-exercises.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/peterhalpin/EDUC_784/edit/master/02_simple_regression.Rmd",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
