<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.11 Exercises | EDUC 784: Regression</title>
  <meta name="description" content="Course notes for EDUC 784" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2.11 Exercises | EDUC 784: Regression" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/image1.png" />
  <meta property="og:description" content="Course notes for EDUC 784" />
  <meta name="github-repo" content="peterhalpin/EDUC_784" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.11 Exercises | EDUC 784: Regression" />
  
  <meta name="twitter:description" content="Course notes for EDUC 784" />
  <meta name="twitter:image" content="/images/image1.png" />

<meta name="author" content="Peter Halpin" />


<meta name="date" content="2022-01-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="null" type="image/x-icon" />
<link rel="prev" href="2.10-power-analysis.html"/>
<link rel="next" href="2.12-review.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Course notes for EDUC 784</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About This Book</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-why-this-book.html"><a href="1.1-why-this-book.html"><i class="fa fa-check"></i><b>1.1</b> Why this book?</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-how-to-use-this-book.html"><a href="1.2-how-to-use-this-book.html"><i class="fa fa-check"></i><b>1.2</b> How to use this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-chapter-2.html"><a href="2-chapter-2.html"><i class="fa fa-check"></i><b>2</b> Simple Regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-an-example-from-nels.html"><a href="2.1-an-example-from-nels.html"><i class="fa fa-check"></i><b>2.1</b> An example from NELS</a></li>
<li class="chapter" data-level="2.2" data-path="2.2-regression-line.html"><a href="2.2-regression-line.html"><i class="fa fa-check"></i><b>2.2</b> The regression line</a></li>
<li class="chapter" data-level="2.3" data-path="2.3-ols.html"><a href="2.3-ols.html"><i class="fa fa-check"></i><b>2.3</b> OLS</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2.3-ols.html"><a href="2.3-ols.html#correlation-and-regression"><i class="fa fa-check"></i><b>2.3.1</b> Correlation and regression</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2.4-r-squared.html"><a href="2.4-r-squared.html"><i class="fa fa-check"></i><b>2.4</b> R-squared</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="2.4-r-squared.html"><a href="2.4-r-squared.html#derivation"><i class="fa fa-check"></i><b>2.4.1</b> Derivation*</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2.5-population-model.html"><a href="2.5-population-model.html"><i class="fa fa-check"></i><b>2.5</b> The population model</a></li>
<li class="chapter" data-level="2.6" data-path="2.6-clarifying-notation.html"><a href="2.6-clarifying-notation.html"><i class="fa fa-check"></i><b>2.6</b> Clarifying notation</a></li>
<li class="chapter" data-level="2.7" data-path="2.7-inference-for-slope.html"><a href="2.7-inference-for-slope.html"><i class="fa fa-check"></i><b>2.7</b> Inference for the slope</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="2.7-inference-for-slope.html"><a href="2.7-inference-for-slope.html#t-tests"><i class="fa fa-check"></i><b>2.7.1</b> t-tests</a></li>
<li class="chapter" data-level="2.7.2" data-path="2.7-inference-for-slope.html"><a href="2.7-inference-for-slope.html#confidence-intervals"><i class="fa fa-check"></i><b>2.7.2</b> Confidence intervals</a></li>
<li class="chapter" data-level="2.7.3" data-path="2.7-inference-for-slope.html"><a href="2.7-inference-for-slope.html#the-nels-example"><i class="fa fa-check"></i><b>2.7.3</b> The NELS example</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="2.8-inference-for-the-intercept.html"><a href="2.8-inference-for-the-intercept.html"><i class="fa fa-check"></i><b>2.8</b> Inference for the intercept</a></li>
<li class="chapter" data-level="2.9" data-path="2.9-inference-for-rsquared.html"><a href="2.9-inference-for-rsquared.html"><i class="fa fa-check"></i><b>2.9</b> Inference for R-squared</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="2.9-inference-for-rsquared.html"><a href="2.9-inference-for-rsquared.html#f-tests"><i class="fa fa-check"></i><b>2.9.1</b> F-tests</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="2.10-power-analysis.html"><a href="2.10-power-analysis.html"><i class="fa fa-check"></i><b>2.10</b> Power analysis</a></li>
<li class="chapter" data-level="2.11" data-path="2.11-exercises.html"><a href="2.11-exercises.html"><i class="fa fa-check"></i><b>2.11</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="2.11-exercises.html"><a href="2.11-exercises.html#the-lm-function"><i class="fa fa-check"></i><b>2.11.1</b> The <code>lm</code> function</a></li>
<li class="chapter" data-level="2.11.2" data-path="2.11-exercises.html"><a href="2.11-exercises.html#predicted-values-and-residuals"><i class="fa fa-check"></i><b>2.11.2</b> Predicted values and residuals</a></li>
<li class="chapter" data-level="2.11.3" data-path="2.11-exercises.html"><a href="2.11-exercises.html#variance-explained"><i class="fa fa-check"></i><b>2.11.3</b> Variance explained</a></li>
<li class="chapter" data-level="2.11.4" data-path="2.11-exercises.html"><a href="2.11-exercises.html#inference"><i class="fa fa-check"></i><b>2.11.4</b> Inference</a></li>
<li class="chapter" data-level="2.11.5" data-path="2.11-exercises.html"><a href="2.11-exercises.html#power-analysis-1"><i class="fa fa-check"></i><b>2.11.5</b> Power analysis</a></li>
<li class="chapter" data-level="2.11.6" data-path="2.11-exercises.html"><a href="2.11-exercises.html#additional-exercises"><i class="fa fa-check"></i><b>2.11.6</b> Additional exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="2.12-review.html"><a href="2.12-review.html"><i class="fa fa-check"></i><b>2.12</b> Review</a>
<ul>
<li class="chapter" data-level="2.12.1" data-path="2.12-review.html"><a href="2.12-review.html#summation-algebra"><i class="fa fa-check"></i><b>2.12.1</b> Summation algebra</a></li>
<li class="chapter" data-level="2.12.2" data-path="2.12-review.html"><a href="2.12-review.html#sample-statistics"><i class="fa fa-check"></i><b>2.12.2</b> Sample statistics</a></li>
<li class="chapter" data-level="2.12.3" data-path="2.12-review.html"><a href="2.12-review.html#bias-and-precision"><i class="fa fa-check"></i><b>2.12.3</b> Bias and precision</a></li>
<li class="chapter" data-level="2.12.4" data-path="2.12-review.html"><a href="2.12-review.html#t-tests-1"><i class="fa fa-check"></i><b>2.12.4</b> t-tests</a></li>
<li class="chapter" data-level="2.12.5" data-path="2.12-review.html"><a href="2.12-review.html#confidence-intervals-1"><i class="fa fa-check"></i><b>2.12.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="2.12.6" data-path="2.12-review.html"><a href="2.12-review.html#f-tests-1"><i class="fa fa-check"></i><b>2.12.6</b> F-tests</a></li>
<li class="chapter" data-level="2.12.7" data-path="2.12-review.html"><a href="2.12-review.html#apa-reporting"><i class="fa fa-check"></i><b>2.12.7</b> APA reporting</a></li>
<li class="chapter" data-level="2.12.8" data-path="2.12-review.html"><a href="2.12-review.html#working-in-r"><i class="fa fa-check"></i><b>2.12.8</b> Working in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-chapter-3.html"><a href="3-chapter-3.html"><i class="fa fa-check"></i><b>3</b> Interpretations of Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-prediction.html"><a href="3.1-prediction.html"><i class="fa fa-check"></i><b>3.1</b> Prediction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="3.1-prediction.html"><a href="3.1-prediction.html#more-about-prediction"><i class="fa fa-check"></i><b>3.1.1</b> More about prediction</a></li>
<li class="chapter" data-level="3.1.2" data-path="3.1-prediction.html"><a href="3.1-prediction.html#regression-toward-the-mean"><i class="fa fa-check"></i><b>3.1.2</b> Regression toward the mean</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3.2-causation.html"><a href="3.2-causation.html"><i class="fa fa-check"></i><b>3.2</b> Causation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="3.2-causation.html"><a href="3.2-causation.html#omitted-variable-bias"><i class="fa fa-check"></i><b>3.2.1</b> Omitted variable bias*</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3.3-explanation.html"><a href="3.3-explanation.html"><i class="fa fa-check"></i><b>3.3</b> Explanation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-chapter-4.html"><a href="4-chapter-4.html"><i class="fa fa-check"></i><b>4</b> Regression with Two Predictors</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-ecls-4.html"><a href="4.1-ecls-4.html"><i class="fa fa-check"></i><b>4.1</b> An example from ECLS</a></li>
<li class="chapter" data-level="4.2" data-path="4.2-the-two-predictor-model.html"><a href="4.2-the-two-predictor-model.html"><i class="fa fa-check"></i><b>4.2</b> The two-predictor model</a></li>
<li class="chapter" data-level="4.3" data-path="4.3-comparison-4.html"><a href="4.3-comparison-4.html"><i class="fa fa-check"></i><b>4.3</b> Multiple vs simple regression</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="4.3-comparison-4.html"><a href="4.3-comparison-4.html#what-is-the-missing-ingredient"><i class="fa fa-check"></i><b>4.3.1</b> What is the missing ingredient?</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="4.4-ols-4.html"><a href="4.4-ols-4.html"><i class="fa fa-check"></i><b>4.4</b> OLS with two predictors</a></li>
<li class="chapter" data-level="4.5" data-path="4.5-interpretation-4.html"><a href="4.5-interpretation-4.html"><i class="fa fa-check"></i><b>4.5</b> Interpreting the coefficients</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="4.5-interpretation-4.html"><a href="4.5-interpretation-4.html#holding-the-other-predictor-constant"><i class="fa fa-check"></i><b>4.5.1</b> “Holding the other predictor constant”</a></li>
<li class="chapter" data-level="4.5.2" data-path="4.5-interpretation-4.html"><a href="4.5-interpretation-4.html#controlling-for-the-other-predictor"><i class="fa fa-check"></i><b>4.5.2</b> “Controlling for the other predictor”</a></li>
<li class="chapter" data-level="4.5.3" data-path="4.5-interpretation-4.html"><a href="4.5-interpretation-4.html#the-ecls-example"><i class="fa fa-check"></i><b>4.5.3</b> The ECLS example</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="4.6-beta-4.html"><a href="4.6-beta-4.html"><i class="fa fa-check"></i><b>4.6</b> Standardized coefficients</a></li>
<li class="chapter" data-level="4.7" data-path="4.7-rsquared-4.html"><a href="4.7-rsquared-4.html"><i class="fa fa-check"></i><b>4.7</b> (Multiple) R-squared</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="4.7-rsquared-4.html"><a href="4.7-rsquared-4.html#the-multiple-correlation"><i class="fa fa-check"></i><b>4.7.1</b> The multiple correlation</a></li>
<li class="chapter" data-level="4.7.2" data-path="4.7-rsquared-4.html"><a href="4.7-rsquared-4.html#relation-with-simple-regression"><i class="fa fa-check"></i><b>4.7.2</b> Relation with simple regression</a></li>
<li class="chapter" data-level="4.7.3" data-path="4.7-rsquared-4.html"><a href="4.7-rsquared-4.html#adjusted-r-squared"><i class="fa fa-check"></i><b>4.7.3</b> Adjusted R-squared</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="4.8-inference-for-slopes-4.html"><a href="4.8-inference-for-slopes-4.html"><i class="fa fa-check"></i><b>4.8</b> Inference for the slopes</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="4.8-inference-for-slopes-4.html"><a href="4.8-inference-for-slopes-4.html#comments-on-precision"><i class="fa fa-check"></i><b>4.8.1</b> Comments on precision</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="4.9-inference-for-rsquared-4.html"><a href="4.9-inference-for-rsquared-4.html"><i class="fa fa-check"></i><b>4.9</b> Inference for R-squared</a></li>
<li class="chapter" data-level="4.10" data-path="4.10-workbook.html"><a href="4.10-workbook.html"><i class="fa fa-check"></i><b>4.10</b> Workbook</a></li>
<li class="chapter" data-level="4.11" data-path="4.11-exercises-1.html"><a href="4.11-exercises-1.html"><i class="fa fa-check"></i><b>4.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-chapter-5.html"><a href="5-chapter-5.html"><i class="fa fa-check"></i><b>5</b> Assumption Checking</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5.1-normality.html"><a href="5.1-normality.html"><i class="fa fa-check"></i><b>5.1</b> Normality</a></li>
<li class="chapter" data-level="5.2" data-path="5.2-homoskedasticity.html"><a href="5.2-homoskedasticity.html"><i class="fa fa-check"></i><b>5.2</b> Homoskedasticity</a></li>
<li class="chapter" data-level="5.3" data-path="5.3-linearity.html"><a href="5.3-linearity.html"><i class="fa fa-check"></i><b>5.3</b> Linearity</a></li>
<li class="chapter" data-level="5.4" data-path="5.4-sensitivity-analysis.html"><a href="5.4-sensitivity-analysis.html"><i class="fa fa-check"></i><b>5.4</b> Sensitivity analysis*</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/peterhalpin/EDUC_784" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EDUC 784: Regression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercises" class="section level2" number="2.11">
<h2><span class="header-section-number">2.11</span> Exercises</h2>
<p>These exercises collect all of the R input used in this chapter in one step-by-step analysis, explain how the R input works, and provides some some additional exercises to work on. We will go through this material in class together.</p>
<div id="the-lm-function" class="section level3" number="2.11.1">
<h3><span class="header-section-number">2.11.1</span> The <code>lm</code> function</h3>
<p>The function<code>lm</code>, short for “linear model,” is used to estimate linear regressions using OLS. It also provides a lot of useful output.</p>
<p>The main argument that the user provides to the <code>lm</code> function is a formula. For the simple regression of Y on X, a formula has the syntax:</p>
<p><code>Y ~ X</code></p>
<p>Here <code>Y</code> denotes the outcome variable and <code>X</code> is the predictor variable. The tilde <code>~</code> just means “equals,” but the equals sign <code>=</code> is already used to assign values in R, so <code>~</code> is used in its place when writing a formula. We will see more complicated formulas as we go through the course. For more information on R’s formula syntax, see <code>help(formula)</code>.</p>
<p>Let’s take a closer look using the following two variables from the NELS data, which is available on Sakai site for the course.</p>
<ul>
<li><p><code>achmat08</code>: eighth grade math achievement (percent correct on a math test)</p></li>
<li><p><code>ses</code>: a composite measure of socio-economic status, on a scale from 0-35</p></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="2.11-exercises.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data. Note that you can click on the .RData file and RStudio will load it</span></span>
<span id="cb18-2"><a href="2.11-exercises.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load(&quot;NELS.RData&quot;) #Un-comment this line to run</span></span>
<span id="cb18-3"><a href="2.11-exercises.html#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="2.11-exercises.html#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Attach the data: will dicuss this in class</span></span>
<span id="cb18-5"><a href="2.11-exercises.html#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># attach(NELS) #Un-comment this line to run!</span></span>
<span id="cb18-6"><a href="2.11-exercises.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="2.11-exercises.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of math achievment against SES</span></span>
<span id="cb18-8"><a href="2.11-exercises.html#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> ses, <span class="at">y =</span> achmat08, <span class="at">col =</span> <span class="st">&quot;#4B9CD3&quot;</span>)</span>
<span id="cb18-9"><a href="2.11-exercises.html#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="2.11-exercises.html#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Regress math achievement on SES; save output as &quot;mod&quot;</span></span>
<span id="cb18-11"><a href="2.11-exercises.html#cb18-11" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(achmat08 <span class="sc">~</span> ses)</span>
<span id="cb18-12"><a href="2.11-exercises.html#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="2.11-exercises.html#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print out the regression coefficients</span></span>
<span id="cb18-14"><a href="2.11-exercises.html#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod)</span></code></pre></div>
<pre><code>## (Intercept)         ses 
##    48.67803     0.42926</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="2.11-exercises.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add the regression line to the plot</span></span>
<span id="cb20-2"><a href="2.11-exercises.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mod)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Let’s do some quick calculations to check that the <code>lm</code> output corresponds the formulas for the slope and intercept in Section <a href="2.3-ols.html#ols">2.3</a>:</p>
<p><span class="math display">\[ a = \bar Y - b \bar X \quad \text{and} \quad b = \frac{\text{Cov}(X, Y)}{s_X^2} \]</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="2.11-exercises.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confirm that the slope from m is just the covariance divided by the variance of X</span></span>
<span id="cb21-2"><a href="2.11-exercises.html#cb21-2" aria-hidden="true" tabindex="-1"></a>cov_xy <span class="ot">&lt;-</span> <span class="fu">cov</span>(achmat08, ses)</span>
<span id="cb21-3"><a href="2.11-exercises.html#cb21-3" aria-hidden="true" tabindex="-1"></a>s_x <span class="ot">&lt;-</span> <span class="fu">var</span>(ses)</span>
<span id="cb21-4"><a href="2.11-exercises.html#cb21-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> cov_xy <span class="sc">/</span> s_x</span>
<span id="cb21-5"><a href="2.11-exercises.html#cb21-5" aria-hidden="true" tabindex="-1"></a>b</span></code></pre></div>
<pre><code>## [1] 0.42926</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="2.11-exercises.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confirm that the y-intercept is obtained from the two means and the slope</span></span>
<span id="cb23-2"><a href="2.11-exercises.html#cb23-2" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(ses)</span>
<span id="cb23-3"><a href="2.11-exercises.html#cb23-3" aria-hidden="true" tabindex="-1"></a>ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(achmat08)</span>
<span id="cb23-4"><a href="2.11-exercises.html#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="2.11-exercises.html#cb23-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> ybar <span class="sc">-</span> b <span class="sc">*</span> xbar</span>
<span id="cb23-6"><a href="2.11-exercises.html#cb23-6" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1] 48.678</code></pre>
<p>Let’s also check our interpretation of the parameters. If the answers to these questions are not clear, please make sure to ask in class!</p>
<ul>
<li><p>What is the predicted value of <code>achmat08</code> when <code>ses</code> is equal to zero?</p></li>
<li><p>How much do the predicted values of <code>achmat08</code> increase for each unit of increase in <code>ses</code>?</p></li>
</ul>
</div>
<div id="predicted-values-and-residuals" class="section level3" number="2.11.2">
<h3><span class="header-section-number">2.11.2</span> Predicted values and residuals</h3>
<p>The <code>lm</code> function also returns the residuals <span class="math inline">\(e_i\)</span> and the predicted values <span class="math inline">\(\widehat{Y_i}\)</span>, which we can access using the <code>$</code> operator. These are useful for various reasons, especially model diagnostics which we discuss later in the course. For now, lets take a look at the residual vs fitted plot.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="2.11-exercises.html#cb25-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> mod<span class="sc">$</span>fitted.values</span>
<span id="cb25-2"><a href="2.11-exercises.html#cb25-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> mod<span class="sc">$</span>resid</span>
<span id="cb25-3"><a href="2.11-exercises.html#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="2.11-exercises.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yhat, res, <span class="at">col =</span> <span class="st">&quot;#4B9CD3&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="2.11-exercises.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(yhat, res)</span></code></pre></div>
<pre><code>## [1] -2.4274e-16</code></pre>
<p>Note that the predicted values are uncorrelated with the residuals – this is always the case in OLS.</p>
</div>
<div id="variance-explained" class="section level3" number="2.11.3">
<h3><span class="header-section-number">2.11.3</span> Variance explained</h3>
<p>Above we found out that the regression coefficient was 0.4-ish. Another way to describe the relationships is by considering the amount of variation in <span class="math inline">\(Y\)</span> that is associated with (or explained by) its relationship with <span class="math inline">\(X\)</span>. Recall that one way to do this is via the variance decomposition</p>
<p><span class="math display">\[ SS_{\text{total}} = SS_{\text{res}} + SS_{\text{reg}}\]</span></p>
<p>from which we can compute the proportion of variation in Y that is associated with the regression model</p>
<p><span class="math display">\[R^2 = \frac{SS_{\text{reg}}}{SS_{\text{total}}}\]</span></p>
<p>Let’s compute <span class="math inline">\(R^2\)</span> “by hand” for our example.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="2.11-exercises.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the sums of squares</span></span>
<span id="cb28-2"><a href="2.11-exercises.html#cb28-2" aria-hidden="true" tabindex="-1"></a>ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(achmat08)</span>
<span id="cb28-3"><a href="2.11-exercises.html#cb28-3" aria-hidden="true" tabindex="-1"></a>ss_total <span class="ot">&lt;-</span> <span class="fu">sum</span>((achmat08 <span class="sc">-</span> ybar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb28-4"><a href="2.11-exercises.html#cb28-4" aria-hidden="true" tabindex="-1"></a>ss_reg <span class="ot">&lt;-</span> <span class="fu">sum</span>((yhat <span class="sc">-</span> ybar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb28-5"><a href="2.11-exercises.html#cb28-5" aria-hidden="true" tabindex="-1"></a>ss_res <span class="ot">&lt;-</span>  <span class="fu">sum</span>((achmat08 <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb28-6"><a href="2.11-exercises.html#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="2.11-exercises.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that SS_total = SS_reg + SS_res</span></span>
<span id="cb28-8"><a href="2.11-exercises.html#cb28-8" aria-hidden="true" tabindex="-1"></a>ss_total</span></code></pre></div>
<pre><code>## [1] 43527</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="2.11-exercises.html#cb30-1" aria-hidden="true" tabindex="-1"></a>ss_reg <span class="sc">+</span> ss_res</span></code></pre></div>
<pre><code>## [1] 43527</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="2.11-exercises.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute R-squared</span></span>
<span id="cb32-2"><a href="2.11-exercises.html#cb32-2" aria-hidden="true" tabindex="-1"></a>ss_reg<span class="sc">/</span>ss_total</span></code></pre></div>
<pre><code>## [1] 0.10128</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="2.11-exercises.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that this is the same as the regression output: </span></span>
<span id="cb34-2"><a href="2.11-exercises.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.10128</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="2.11-exercises.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that R-squared is really equal to the square of the PPMC</span></span>
<span id="cb36-2"><a href="2.11-exercises.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(achmat08, ses)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 0.10128</code></pre>
</div>
<div id="inference" class="section level3" number="2.11.4">
<h3><span class="header-section-number">2.11.4</span> Inference</h3>
<p>At this point we can say that SES explained about 10% of the variation in eighth grade students’ math achievement, in our sample. However, we haven’t yet talked about statistical inference, or how we can make conclusions about a population based on a sample from that population.</p>
<p>Let’s use the <code>summary</code> function to test the coefficients in our model.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="2.11-exercises.html#cb38-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(achmat08 <span class="sc">~</span> ses)</span>
<span id="cb38-2"><a href="2.11-exercises.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = achmat08 ~ ses)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -20.600  -6.552  -0.148   6.023  27.663 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  48.6780     1.1282   43.15  &lt; 2e-16 ***
## ses           0.4293     0.0573    7.49  3.1e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.86 on 498 degrees of freedom
## Multiple R-squared:  0.101,  Adjusted R-squared:  0.0995 
## F-statistic: 56.1 on 1 and 498 DF,  p-value: 3.13e-13</code></pre>
<p>In the table, the t-test and p-values are for the null hypothesis that the corresponding coefficient is zero in the population. We can see that the intercept and slope are both significantly different from zero at the .05 level, however, the test of the slope is not very meaningful.</p>
<p>The text below the table summarizes the output for R-squared, including its F-test, it’s degrees of freedom, and the p-value. (We will talk about adjusted R-square in Chapter 4)</p>
<p>We can use the <code>confint</code> function to obtain confidence intervals for the regression coefficients. Use <code>help</code> to find out more about the <code>confint</code> function.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="2.11-exercises.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod)</span></code></pre></div>
<pre><code>##                2.5 %   97.5 %
## (Intercept) 46.46146 50.89461
## ses          0.31668  0.54184</code></pre>
<p>Be sure to remember the correct interpretation of confidence intervals: <em>there is a 95% chance that the interval includes the true parameter value</em> (not: there is a 95% chance that the parameter falls in the interval). For example, there is a 95% chance that the interval [.31, .54] includes the true regression coefficient for SES.</p>
</div>
<div id="power-analysis-1" class="section level3" number="2.11.5">
<h3><span class="header-section-number">2.11.5</span> Power analysis</h3>
<p>Power analyses should ideally be done prospectively – i.e., before the data are collected. Since this class will work with secondary data analyses, most of our analyses will be retrospective. But don’t let this mislead you about the importance of statistical power – you should always do a power analysis before collecting data!!</p>
<p>To do a power analsyes in R, we can install and load the <code>pwr</code> package. If you haven’t installed an R package before it’s pretty straight forward – but just ask the instructor or a fellow student if you run into any issues.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="2.11-exercises.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install the package </span></span>
<span id="cb42-2"><a href="2.11-exercises.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;pwr&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="2.11-exercises.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the package by using the library command</span></span>
<span id="cb43-2"><a href="2.11-exercises.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;pwr&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="2.11-exercises.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the help menu to see what the package does</span></span>
<span id="cb44-2"><a href="2.11-exercises.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(<span class="st">&quot;pwr-package&quot;</span>)</span></code></pre></div>
<p>To do a power analysis for linear regression, it is common to use Cohen’s <span class="math inline">\(f^2\)</span> as the effect size:</p>
<p><span class="math display">\[f^2 = \frac{R^2}{1-R^2}.\]</span></p>
<p>Recall that <span class="math inline">\(R^2\)</span> is the proportion of variance in <span class="math inline">\(Y\)</span> explained by the model, and so <span class="math inline">\(1 - R^2\)</span> is the proportion of variance not explained by the model. Thus, <span class="math inline">\(f^2\)</span> can be interpreted as a signal to noise ratio.</p>
<p>In addition to the effect size, we need to know the degrees of freedom for the F-test of R-square. The <code>pwr</code> functions use the following notation:</p>
<ul>
<li><code>u</code> is the degrees of freedom in the numerator of an F-test.</li>
<li><code>v</code> is the degrees of freedom in the denominator of an F-test.</li>
</ul>
<p>In simple regression, <code>u = 1</code> and <code>v = N - 2</code>.</p>
<p>As an example of (prospective) power analysis, let’s find out many observations would be required to detect an effet size of R-square = .1, using <span class="math inline">\(\alpha = .05\)</span> and power = .8? To find the answer, enter the provided information into the <code>pwr.f2.test</code> function, and the function will solve for the “missing piece” – in this case <span class="math inline">\(v = N - 2\)</span>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="2.11-exercises.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the provided values of R2, alpha, power (and u = 1) to solve for v = N - 2</span></span>
<span id="cb45-2"><a href="2.11-exercises.html#cb45-2" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> .<span class="dv">1</span></span>
<span id="cb45-3"><a href="2.11-exercises.html#cb45-3" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> R2<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>R2)</span>
<span id="cb45-4"><a href="2.11-exercises.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.f2.test</span>(<span class="at">u =</span> <span class="dv">1</span>, <span class="at">f2 =</span> f2, <span class="at">sig.level =</span> .<span class="dv">05</span>, <span class="at">power =</span> .<span class="dv">8</span>)</span></code></pre></div>
<pre><code>## 
##      Multiple regression power calculation 
## 
##               u = 1
##               v = 70.611
##              f2 = 0.11111
##       sig.level = 0.05
##           power = 0.8</code></pre>
<p>In this example we find that <span class="math inline">\(v = 70.6\)</span>. Since <span class="math inline">\(v = N - 2\)</span>, so we know that a sample size of <span class="math inline">\(N = 72.6\)</span> (rounded up to 73) is required to reject the null hypothesis that <span class="math inline">\(R^2 = 0\)</span>, when the true population value is <span class="math inline">\(R^2 = .1\)</span>, with a power of .8 and using a significance level of .05.</p>
</div>
<div id="additional-exercises" class="section level3" number="2.11.6">
<h3><span class="header-section-number">2.11.6</span> Additional exercises</h3>
<p>If time permits, we will address these additional exercises in class. If you want more practice with R, please take a look at the review materials (on Sakai as of week 2; will be updated in the following section of the book as time permits).</p>
<p>These exercises replace <code>achmat08</code> with</p>
<ul>
<li><code>achrdg08</code>: eighth grade reading achievement (percent correct on a reading test)</li>
</ul>
<p>Please answer the following questions using R.</p>
<ul>
<li><p>Plot <code>achrdg08</code> against <code>ses</code>. Is there any evidence of nonlinearity in the relationship?</p></li>
<li><p>What is the correlation between <code>achrdg08</code> and <code>ses</code>? How does it compare to the correlation with Math and SES?</p></li>
<li><p>How much variation in Reading is explained by SES? Is this more or less than for Math? Is the proportion of variance explained significant at the .05 level?</p></li>
<li><p>How much do predicted Reading scores increase for a one unit of increase in SES? Is this a statistically significant at the .05 level?</p></li>
<li><p>What are your overall conclusions about the relationship between Academic Achievement and SES in the NELS data?</p></li>
</ul>
<p>If you want more practice with R please take a look at the Review materials (on Sakai as of week 2; will be updated in the following section of the book as time permits).</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2.10-power-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="2.12-review.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/peterhalpin/EDUC_784/edit/master/02_simple_regression.Rmd",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
